(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var a=n.getElementsByTagName("script");if(a.length)for(var l=a.length-1;l>-1&&!t;)t=a[l--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=(e,t,n="",a="",l="",o=!1)=>{let s;return s=o?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t),n&&s.setAttribute("class",n),"object"==typeof l&&Object.entries(l).forEach((([e,t])=>{s.setAttribute(e,t)})),a&&(s.textContent=a),e&&e.append(s),s},n=(e,t,n=null)=>{e.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:n}))};let a,l=0;const o=t(null,"span","header__timer","00:00"),s=()=>l,r=()=>{const e=Math.floor(l/60),t=l%60;return`${`${e}`.padStart(2,"0")}:${`${t}`.padStart(2,"0")}`},d=()=>{o.textContent=r()},i=()=>{clearInterval(a),a=setInterval((()=>{l+=1,d()}),1e3)},c=()=>{clearInterval(a),l=0,d()},m=[{size:5,name:"Airplane",matrix:[[0,0,1,0,0],[0,1,1,1,0],[1,1,1,1,1],[0,0,1,0,0],[0,1,1,1,0]]},{size:5,name:"Tower",matrix:[[1,0,1,0,1],[1,1,1,1,1],[0,1,1,1,0],[0,1,0,1,0],[0,1,1,1,0]]},{size:5,name:"Snowflake",matrix:[[1,0,1,0,1],[0,1,1,1,0],[1,1,0,1,1],[0,1,1,1,0],[1,0,1,0,1]]},{size:5,name:"Dog",matrix:[[0,0,0,1,0],[1,0,1,1,1],[0,1,1,1,0],[0,1,0,1,0],[0,1,0,1,0]]},{size:5,name:"Skull",matrix:[[0,1,1,1,0],[1,1,1,1,1],[1,0,1,0,1],[1,1,1,1,1],[0,1,0,1,0]]},{size:10,name:"Tree",matrix:[[0,0,1,1,1,1,1,1,0,0],[0,1,1,1,1,0,1,1,1,0],[1,1,1,1,1,0,1,1,1,1],[1,1,0,1,1,1,0,0,1,1],[1,1,1,0,1,1,1,1,1,0],[0,1,1,1,1,1,0,0,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,1,0,0,1,1,0,0,0,1],[1,1,1,1,1,1,1,1,1,1]]},{size:10,name:"TV",matrix:[[0,0,1,0,0,0,0,1,0,0],[0,0,0,1,0,0,1,0,0,0],[1,1,1,1,1,1,1,1,1,1],[1,0,1,1,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,0,1],[1,0,1,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1],[0,1,0,0,0,0,0,0,1,0]]},{size:10,name:"Clock",matrix:[[0,1,1,0,0,0,0,1,1,0],[1,1,0,1,1,1,1,0,1,1],[1,0,1,1,1,0,1,1,0,1],[0,1,1,1,1,0,1,1,1,0],[0,1,1,1,1,0,1,1,1,0],[0,1,1,1,0,1,1,1,1,0],[0,1,1,0,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,0,0],[0,0,0,1,1,1,1,0,0,0],[0,0,1,1,0,0,1,1,0,0]]},{size:10,name:"Duck",matrix:[[0,1,1,1,0,0,0,0,0,0],[1,1,0,1,1,0,0,0,0,0],[0,1,1,1,1,0,0,0,1,1],[0,0,0,1,1,0,0,0,1,1],[0,0,0,1,1,1,1,1,1,1],[1,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,1,0,0,0,0,0],[0,0,0,1,1,0,0,0,0,0]]},{size:10,name:"Clown",matrix:[[0,0,0,1,1,1,1,0,0,0],[0,0,1,0,0,1,1,1,0,0],[1,1,1,1,1,1,1,1,1,1],[0,1,0,1,0,0,1,0,1,0],[1,0,0,0,1,1,0,0,0,1],[1,0,0,0,1,1,0,0,0,1],[0,1,0,0,0,0,1,0,1,0],[0,1,0,0,1,1,0,0,1,0],[0,0,1,0,0,0,0,1,0,0],[0,1,1,1,1,1,1,1,1,0]]},{size:15,name:"Skeleton",matrix:[[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0],[0,0,0,0,0,1,0,1,0,1,0,0,0,1,0],[0,0,0,0,0,1,1,1,1,1,0,0,1,1,1],[0,0,0,0,0,0,1,1,1,0,0,1,1,1,1],[0,1,1,1,0,0,0,1,0,0,0,0,1,1,1],[1,1,0,1,0,1,1,0,1,1,1,0,0,1,0],[1,0,0,0,1,0,0,1,0,0,1,1,0,1,0],[1,0,0,0,1,1,1,0,1,1,0,1,1,1,0],[1,0,0,0,1,0,0,1,0,0,0,0,1,1,0],[1,1,0,1,1,0,1,1,1,0,0,0,1,0,0],[0,1,1,1,0,1,1,1,1,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,1,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,1,1,1,0,0,0]]},{size:15,name:"Potion",matrix:[[0,0,0,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,0,1,1,1,0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0],[0,0,0,0,0,1,0,1,1,1,0,0,0,0,0],[0,0,0,0,1,1,0,1,1,1,1,0,0,0,0],[0,0,0,0,1,1,0,1,1,1,1,0,0,0,0],[0,0,0,0,1,1,0,1,1,1,1,0,0,0,0],[0,0,0,1,1,0,0,1,1,1,1,1,0,0,0],[0,0,1,1,0,0,1,1,1,1,1,1,1,0,0],[0,1,1,0,0,0,1,1,1,1,1,1,1,1,0],[1,1,0,0,0,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1,1,1,1,1,1],[0,1,1,1,0,0,0,0,0,0,0,0,1,1,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,0,0]]},{size:15,name:"Chest",matrix:[[0,0,0,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,1,1,0,0,1,0,0,1,0,0,1,0,0],[0,1,1,0,0,1,0,0,1,0,0,1,1,1,0],[0,1,1,0,0,1,0,0,1,0,0,1,1,1,1],[1,1,0,0,1,0,0,1,0,0,1,1,1,1,1],[1,1,0,0,1,0,0,1,0,0,1,1,1,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,0,0,0,1],[1,0,0,0,1,1,1,0,0,0,1,0,0,0,1],[1,0,0,0,1,0,1,0,0,0,1,0,0,0,1],[1,0,0,0,1,0,1,0,0,0,1,0,0,1,1],[1,0,0,0,0,1,0,0,0,0,1,0,1,1,0],[1,0,0,0,0,0,0,0,0,0,1,1,1,0,0],[1,1,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,0,0,0,0]]},{size:15,name:"Swan",matrix:[[1,1,1,1,1,1,1,1,1,1,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,0,1,1,1,1,1],[0,1,1,0,0,1,1,1,1,1,0,1,1,1,1],[1,0,0,1,0,0,0,0,1,1,0,1,1,1,1],[1,1,0,0,1,1,0,0,0,1,1,0,1,1,1],[1,1,0,1,0,0,1,1,0,1,1,0,0,1,1],[1,1,1,0,1,1,0,0,1,0,1,1,0,0,1],[1,1,1,0,0,0,1,1,0,1,0,0,1,0,1],[1,1,1,0,1,1,0,0,1,0,0,0,1,0,1],[0,1,1,0,0,0,1,1,0,1,0,0,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]},{size:15,name:"Turtle",matrix:[[0,0,1,0,1,1,0,0,1,1,0,0,0,0,1],[0,0,1,1,1,1,1,0,1,1,1,0,0,0,0],[0,0,1,0,1,1,0,0,0,1,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[1,1,0,0,1,1,1,1,0,0,1,1,0,0,0],[1,1,1,1,1,1,0,1,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,0,1,1,1,0,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1,0,1,1,0],[1,1,1,1,1,1,1,1,1,1,1,0,0,0,0],[1,1,0,0,1,1,1,1,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,1,0,1,0],[1,0,1,1,0,0,0,0,0,1,1,0,0,1,1],[1,1,1,1,1,0,0,0,1,1,1,0,0,1,0],[1,0,1,1,0,0,0,0,1,1,0,0,0,0,0]]}],u=t(null,"div","header__selects"),_=t(u,"select","header__select header__select--size"),g=t(u,"select","header__select header__select--template"),h=()=>{const e=+_.value.split("x")[0];g.innerHTML="",m.filter((t=>t.size===e)).forEach((e=>{t(g,"option","header__option",`${e.name}`)}))},p=()=>{n(document,"templateChange",{size:_.value,name:g.value,matrix:m.find((e=>e.name===g.value)).matrix})},v=(e,t)=>{_.value=e,h(),g.value=t,g.dispatchEvent(new Event("change"))},f=e.p+"97cdb751d279a8f23228.mp3",b=e.p+"357610c731228c80b39d.mp3",L=e.p+"2f607e1208102e5b3a9e.mp3",x=e.p+"efc98aa43323f3df3e74.mp3",E="izyNonogram",y=()=>null!==localStorage.getItem(E),S=()=>JSON.parse(localStorage.getItem(E)),w=e=>{if(!y())return null;const t=S();return void 0===t[e]?null:t[e]},z=(e,t)=>{let n={};var a;y()&&(n=S()),n[e]=t,a=n,localStorage.setItem(E,JSON.stringify(a))},k=w("isSoundOn");let $=null===k||k;const C=t(null,"li","header__item"),T=t(C,"button","header__button header__button--sound_"+($?"on":"off"),"",{type:"button"}),A=t(T,"span","visually-hidden","Sound "+($?"on":"off")),I=e=>{$&&new Audio(e).play()};T.addEventListener("click",(()=>{$=!$,z("isSoundOn",$),T.classList.toggle("header__button--sound_on"),T.classList.toggle("header__button--sound_off"),A.textContent=$?"Sound on":"Sound off"}));const N=w("theme");let M=null===N?"light":N;const q=t(null,"header","header"),F=t(null,"h1","header__title","Nonograms"),H=t(null,"ul","header__buttons"),R=t(null,"li","header__item"),O=t(null,"li","header__item"),P=t(R,"button",`header__button header__button--theme_${M}`,"",{type:"button"}),j=t(O,"button","header__button header__button--scores","",{type:"button"}),D=t(P,"span","visually-hidden",`${M.charAt(0).toUpperCase()}${M.slice(1)} theme`);t(j,"span","visually-hidden","High score table"),q.append(F,o,u,H),H.append(R,C,O);let J,U,W=[];const B=t(null,"div","game-board__game-field game-field"),G=()=>W.reduce(((e,t)=>e+t.reduce(((e,t)=>0===t?e+1:e),0)),0),K=e=>{const t=parseInt(e.parentNode.dataset.row,10),n=parseInt(e.dataset.column,10);return 1===W[t][n]},V=()=>{B.querySelectorAll(".game-field__cell").forEach((e=>{e.classList.remove("game-field__cell--box"),e.classList.remove("game-field__cell--cross")}))},Y=(e,t=!0)=>{K(e)?e.classList.contains("game-field__cell--box")?J-=1:t&&(J+=1):e.classList.contains("game-field__cell--box")?J+=1:t&&(J-=1),U&&n(document,"timerStart"),U=!1,J===W.length**2&&(n(document,"gameWin",J),B.removeEventListener("click",X),B.removeEventListener("contextmenu",Z),B.classList.add("game-field--default-cursor"),B.querySelectorAll(".game-field__cell--cross").forEach((e=>e.classList.remove("game-field__cell--cross"))))},Q=(e,t=!0)=>{t?e.classList.contains("game-field__cell--box")?n(document,"cellFlagChange","empty"):n(document,"cellFlagChange","box"):e.classList.contains("game-field__cell--cross")?n(document,"cellFlagChange","empty"):n(document,"cellFlagChange","cross")},X=e=>{const t=e.target.closest(".game-field__cell");t&&(Q(t),Y(t),t.classList.remove("game-field__cell--cross"),t.classList.toggle("game-field__cell--box"))},Z=e=>{const t=e.target.closest(".game-field__cell");t&&(Y(t,!1),Q(t,!1),t.classList.remove("game-field__cell--box"),t.classList.toggle("game-field__cell--cross"))},ee=()=>{B.removeEventListener("click",X),B.removeEventListener("contextmenu",Z),B.addEventListener("click",X),B.addEventListener("contextmenu",Z),B.classList.remove("game-field--default-cursor")};B.addEventListener("contextmenu",(e=>e.preventDefault()));const te="left",ne=t(null,"main","main-content"),ae=t(ne,"div","game-board"),le=t(null,"div","game-board__top-clue top-clue"),oe=t(null,"div","game-board__left-clue left-clue");ae.append(le,oe,B);const se=(e,n,a)=>{const l=a===te?oe:le,o=a===te?"row":"column";l.innerHTML="";for(let s=0;s<e;s+=1){const e=t(l,"div",`${a}-clue__${o}`);for(let l=0;l<n[s].length;l+=1)t(e,"div",`${a}-clue__cell`,n[s][l])}},re=e=>{const t=e.map((e=>e.reduce(((e,t)=>(t?e[e.length-1]+=1:e.push(0),e)),[0]).filter((e=>e>0)))),n=Math.max(...t.map((e=>e.length)));return t.map((e=>{const t=n-e.length;return[...Array(t).fill(""),...e]}))},de=t(null,"footer","footer"),ie=t(de,"button","footer__button","Reset game",{type:"button"}),ce=t(de,"button","footer__button","Random game",{type:"button"}),me=t(de,"button","footer__button","Solution",{type:"button"}),ue=t(de,"button","footer__button","Save game",{type:"button"}),_e=t(de,"button","footer__button","Continue last game",{type:"button"}),ge=()=>{ue.disabled=!0},he=()=>{ue.disabled=!1},pe=()=>{me.disabled=!0},ve=()=>{me.disabled=!1},fe={"5x5":"Easy","10x10":"Medium","15x15":"Hard"},be=t(null,"div","modal modal--closed"),Le=t(be,"div","modal__content"),xe=t(Le,"h2","modal__title"),Ee=t(Le,"button","modal__button","OK",{type:"button"}),ye=t(null,"p","modal__text"),Se=t(null,"table","modal__table"),we=(e,...n)=>{const a=t(Se,"tr","modal__row");let l=!0;return n.forEach((n=>{e||l?t(a,"th","modal__cell modal__cell--header",n):t(a,"td","modal__cell",n),l=!1})),a},ze=()=>{setTimeout((()=>{Ee.focus(),be.classList.add("modal--opaque")}),0),be.classList.remove("modal--closed"),document.body.classList.add("no-scroll")},ke=()=>{be.classList.remove("modal--opaque"),setTimeout((()=>{be.classList.add("modal--closed"),document.body.classList.remove("no-scroll"),ye.remove(),Se.remove()}),600)};document.addEventListener("keydown",(e=>{"Escape"===e.key&&ke()})),Ee.addEventListener("click",ke),be.addEventListener("click",(e=>{e.composedPath().includes(Le)||ke()}));let $e=[],Ce={},Te=!1;const Ae=()=>{var e;clearInterval(a),e=`You have solved the ${Ce.name} nonogram in ${s()} seconds!`,ze(),xe.textContent="Great!",ye.textContent=e,xe.after(ye),I(x),j.disabled=!1,ge(),pe(),((e,t,n,a)=>{let l=w("wins");null===l&&(l=[]),l.length>=5&&l.shift(),l.push({size:e,name:t,time:n,formattedTime:a}),z("wins",l)})(Ce.size,Ce.name,s(),r())},Ie=()=>{Ce.matrix,J=G(),U=!0,ee(),V(),c(),he(),ve()},Ne=()=>{z("savedTemplateSize",Ce.size),z("savedTemplateName",Ce.name),z("savedFlaggedCells",(()=>{const e=[];return B.querySelectorAll(".game-field__cell").forEach((t=>{t.classList.contains("game-field__cell--box")?e.push([t.parentNode.dataset.row,t.dataset.column,1]):t.classList.contains("game-field__cell--cross")&&e.push([t.parentNode.dataset.row,t.dataset.column,2])})),e})()),z("savedTimeInSeconds",s())},Me=()=>{var e;v(w("savedTemplateSize"),w("savedTemplateName")),e=w("savedTimeInSeconds"),l=e,d(),i(),w("savedFlaggedCells").forEach((e=>{const t=B.querySelector(`[data-row="${e[0]}"]`).querySelector(`[data-column="${e[1]}"]`);t.classList.add("game-field__cell--"+(1===e[2]?"box":"cross")),K(t)&&1===e[2]?J+=1:1===e[2]&&(J-=1)})),ge()},qe=()=>{const e=(()=>{const e=[...m.keys()].filter((e=>!$e.includes(e)));return e[Math.floor(Math.random()*e.length)]})(),{size:t}=m[e];Te=!0,v(`${t}x${t}`,m[e].name),$e.push(e),$e.length===m.length&&($e=[e])},Fe=()=>{(()=>{const e=B.querySelectorAll(".game-field__cell");B.removeEventListener("click",X),B.removeEventListener("contextmenu",Z),B.classList.add("game-field--default-cursor"),V(),e.forEach((e=>{K(e)&&e.classList.add("game-field__cell--box")}))})(),c(),ge()},He=()=>{var e;e=w("wins"),ze(),xe.textContent="List of recent win results:",(e=>{const t=e.toSorted(((e,t)=>e.time-t.time));Se.innerHTML="",we(!0,"Rank","Nonogram","Difficulty","Time"),t.forEach(((e,t)=>{we(!1,t+1,e.name,`${fe[e.size]} (${e.size})`,e.formattedTime)}))})(e),xe.after(Se)},Re=e=>{var n,a,l;Ce=e.detail,(e=>{const t=re(e),n=(e=>{const t=e[0].map(((t,n)=>e.map((e=>e[n]))));return re(t)})(e),a=n[0].length,l=t[0].length;se(e.length,n,"top"),se(e.length,t,te),ae.style.setProperty("--top-clue-height",a),ae.style.setProperty("--left-clue-width",l),ae.style.setProperty("--field-size",e.length)})(n=Ce.matrix),(e=>{W=e,J=G(),U=!0,(()=>{const e=W.length;B.innerHTML="";for(let n=0;n<e;n+=1){const a=t(B,"div","game-field__row","",{"data-row":n});for(let n=0;n<e;n+=1)t(a,"div","game-field__cell","",{"data-column":n})}})(),ee()})(n),(e=>{let t="";e.forEach((e=>{t+=`${e.map((e=>e?"⬛":"⬜")).join("")}\n`})),console.clear(),console.log(t)})(Ce.matrix),c(),he(),ve(),Te||($e=[(a=Ce.size,l=Ce.name,m.findIndex((e=>e.size===+a.split("x")[0]&&e.name===l)))]),Te=!1},Oe=e=>{"box"===e.detail?I(f):"cross"===e.detail?I(b):I(L),he()};document.body.append(q,ne,de,be),"dark"===M&&document.body.classList.add("dark-theme"),null===w("wins")&&(j.disabled=!0),P.addEventListener("click",(()=>{M="light"===M?"dark":"light",document.body.classList.toggle("dark-theme"),z("theme",M),P.classList.toggle("header__button--theme_light"),P.classList.toggle("header__button--theme_dark"),D.textContent=`${M.charAt(0).toUpperCase()}${M.slice(1)} theme`})),j.addEventListener("click",(()=>{null===w("wins")?j.disabled=!0:n(document,"scoresShow")})),document.addEventListener("templateChange",Re),document.addEventListener("cellFlagChange",Oe),document.addEventListener("gameWin",Ae),document.addEventListener("gameReset",Ie),document.addEventListener("gameSave",Ne),document.addEventListener("gameContinue",Me),document.addEventListener("gameRandom",qe),document.addEventListener("gameSolution",Fe),document.addEventListener("timerStart",i),document.addEventListener("scoresShow",He),(()=>{const e=[...new Set(m.map((e=>e.size)))];_.innerHTML="",e.forEach((e=>{t(_,"option","header__option",`${e}x${e}`)}))})(),h(),p(),_.addEventListener("change",(()=>{h(),p(),_.blur()})),g.addEventListener("change",(()=>{p(),g.blur()})),null===w("savedTemplateSize")&&(_e.disabled=!0),ie.addEventListener("click",(()=>{n(document,"gameReset")})),ue.addEventListener("click",(()=>{n(document,"gameSave"),_e.disabled=!1})),_e.addEventListener("click",(()=>{null===w("savedTemplateSize")?_e.disabled=!0:n(document,"gameContinue")})),ce.addEventListener("click",(()=>{n(document,"gameRandom")})),me.addEventListener("click",(()=>{n(document,"gameSolution"),pe()}))})();
//# sourceMappingURL=main.js.map